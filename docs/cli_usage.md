# CLI Usage

The Py++ CLI can initialize Py++ projects, transpile your code to C++, and build and run the generated C++ CMake project (if you don't want to use the CMake commands directly).

## Primary Workflow

You can initialize your Py++ project in your current directory with:

```console
pypp init
```

This will give you a `python` directory where the code you write will go, a `cpp` directory where the C++ code will be generated to, a `resources` directory where your program can load files from, and a `pypp_files` directory which holds Py++ project metadata.

Once you have some code written, or are using the example code generated by `init`, you can transpile your project to C++ with:

```console
pypp do transpile
```

It is also useful to format your code at the same time as transpiling, otherwise the generated code will be just a few long lines and unreadable. So, instead of the above command, you can transpile and format at the same time with:

```console
pypp do transpile format
```

At this point, you will have a CMake project in the `cpp` directory that you can use. You can do the usual CMake commands to build your project. There is also a `pypp` command to help you build the CMake project if that works for your situation:

```console
pypp do build
```

This command just runs `cmake -S . -B build -DCMAKE_BUILD_TYPE=Release` and `cmake --build build --config Release` together.

There is also a `pypp` command to help you run your generated executable (the executable is called `main` in this example):

```console
pypp do run -e main
```

Or, you can also do the `transpile`, `format`, `build`, and `run` all at the same time with

```console
pypp do transpile format build run -e main
```

## Other commands

There are other `init` commands for initializing projects of the two types of Py++ external libraries, pure-libraries, and bridge-libraries.

```console
pypp init_pure_lib
```

```console
pypp init_brdige_lib
```

There is a `delete_timestamps` command which just removes the `file_timestamps.json` under the `pypp_files` directory. Py++ uses this file to determine which Python files it should transpile to C++. If a file has not been modified since the last transpile, Py++ won't transpile it again. So, deleting the timestamps file will result in Py++ transpiling all your Python files over. This can be useful to do if you have updated your `pypp` version or installed/uninstalled any libraries (you might want to do a fresh transpile).

```console
pypp delete_timestamps
```

## Summary list of commands

- `init`
- `init_pure_lib`
- `init_bridge_lib`
- `do`
- `do_pure_lib`
- `delete_timestamps`

## Other usage tips

CLI commands `do`, `do_pure_lib`, and `delete_timestamps` must be run from the Py++ project root (i.e. where there exists a `pypp_files/proj_info.json` file).

If you want a file or folder to be ignored by the transpiler then you can specify them in the `pypp_files/proj_info.json` file in the `ignore_src_files` and `ignore_main_files` fields, which support wildcard matching. I.e.:

```json
{
    "cpp_dir_is_dirty": false,
    "ignore_src_files": ["src_file.py", "wip_dir/**"],
    "ignore_main_files": ["main.py"]
}
```

## Troubleshooting

If you are experiencing an unexpected issue, try this:

- Delete the entire `cpp` directory
- Delete the `pypp_files/file_timestamps.json` file
- In `pypp_files/proj_info.json`, set `cpp_dir_is_dirty` to `true`

Then, try to transpile and build again.
