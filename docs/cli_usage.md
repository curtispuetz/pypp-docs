# CLI Usage

The Py++ CLI can initialize Py++ projects, transpile your code to C++, and build and run the generated C++ CMake project (if you don't want to use the CMake commands directly).

## Primary Workflow

You can initialize your Py++ project in your current directory with:

```console
pypp init
```

TODO: fix this

This will give you a `python` directory where the code you write will go, a `cpp` directory where the C++ code will be generated to, a `resources` directory where your program can load files from, and a `pypp_files` directory which holds Py++ project metadata.

Once you have some code written, or are using the example code generated by `init`, you can transpile your project to C++ with:

```console
pypp do transpile
```

It is also useful to format your code at the same time as transpiling, otherwise the generated code will be just a few long lines and unreadable. So, instead of the above command, you can transpile and format at the same time with:

```console
pypp do transpile format
```

At this point, you will have a CMake project in the `.pypp/cpp` directory that you can use. You can do the usual CMake commands to build your project. There is also a `pypp` command to help you build the CMake project if you are using the `clang` compiler:

```console
pypp do build
```

This command just runs `cmake -S . -B build -G "Ninja" -DCMAKE_C_COMPILER=clang -DCMAKE_CXX_COMPILER=clang++ -DCMAKE_BUILD_TYPE=Release` and `cmake --build build --config Release` together.

There is also a `pypp` command to help you run your generated executable if your executable is exactly at `.pypp/cpp/build/my_exe_name.exe`:

```console
pypp do run -e my_exe_name
```

Or, you can also do the `transpile`, `format`, `build`, and `run` all at the same time with

```console
pypp do transpile format build run -e main
```

## Other commands

TODO: I think just delete these

There are other `init` commands for initializing projects of the two types of Py++ external libraries, pure-libraries, and bridge-libraries.

```console
pypp init_pure_lib
```

```console
pypp init_brdige_lib
```

There is a `delete_timestamps` command which just removes the `file_timestamps.json` under the `pypp_files` directory. Py++ uses this file to determine which Python files it should transpile to C++. If a file has not been modified since the last transpile, Py++ won't transpile it again. So, deleting the timestamps file will result in Py++ transpiling all your Python files over. This can be useful to do if you have updated your `pypp` version or installed/uninstalled any libraries (you might want to do a fresh transpile).

TODO: I think I need like a `clean_cpp` and a `clean_libs` command. The former should be done when you update the Py++ CLI and the latter should be done when you install or uninstall libraries. Also, in both cases, `delete_timestamps` should also be done.

```console
pypp delete_timestamps
```

## Summary list of commands

- `init`
- `init_pure_lib`
- `init_bridge_lib`
- `do`
- `do_pure_lib`
- `delete_timestamps`

## Other usage tips

TODO: update this

CLI commands `do`, `do_pure_lib`, and `delete_timestamps` must be run from the Py++ project root (i.e. where there exists a `pypp_files/proj_info.json` file).

If you want a file or folder to be ignored by the transpiler, you can specify that in your [`proj_info.json` file](transpiler_features/proj_info_json.md)

## Troubleshooting

If you are experiencing an unexpected issue, try this:

- Delete the entire `cpp` directory
- Delete the `pypp_files/file_timestamps.json` file
- In `pypp_files/proj_info.json`, set `cpp_dir_is_dirty` to `true`

TODO: probably when the `clean_cpp` command is run, I should just set cpp_dir_is_dirty to true and I should delete the timestamps file too. But not for the `clean_libs` command.

Then, try to transpile and build again.
